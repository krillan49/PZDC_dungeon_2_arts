**PZDC_dungeon_2. Часть 2я: Архитектура в общих чертах.**

__База данных__ - представляет из себя просто набор yml фаилов, состоит из 3х частей:
1. `\data` - статические данные, начальные характеристики персонажей, противников, амуниции итд.
2. `\saves` - временные данные, о прогрессии конкретного персонажа и игры в целом. Фаилы генерируются при первом запуске или при создании нового персонажа и начале нового данжа.
3. `\wiews` - шаблоны экранов а так же субэкранов и текстовых изображений для интеграции в экраны и субэкраны (подробнее о вьюхах в следующих постах)

__Модели__ - предоставляют методы сущностей как для отображения информации на экранах, так и методы для обработки сервисами и энджинами при расчете игровой логики. Тк шаблоны для экранов и метод их наполнения самопальный и накладывает много ограничений, приходится злоупотреблять в моделях применением `method_missing`. Возможно стоило бы разделить модели на 2 типа одни для экранов, другие для игровой логики, хз. Некоторые модели основаны на данных из БД, некоторые все еще содержат изначальные данные в константах (например модели навыков), в будущем нужно будет вынести это в `\data`.

__Контроллеры__ - на данный момент самый сумбурный компонент, тк помимо CRUD, некоторые классы или модули названные контроллерами  содержат методы навыков или действий(например `\controllers\characters\hero_actions`), либо содержат комплексную игровую логику и скорее должны быть частично перенесены в `\engines`(например `\controllers\characters\hero_updator`). Возможно вообще стоит отказаться от концепции контроллеров.

__Сервисы__ - отвечают за различные элементы игоровой логики, например методы дропа лута или процесса энчанта амуниции. Так же тут пока что находятся классы для обработки временных фаилов сохранений текущего персонажа и данжа, возможно стоит их перенести.

__Рендереры__ - интегрируют субэкраны, графику и значение методов экземпляра моделей в экраны и субэкраны. Их концепцию как и yml-вьюхи для них пришлось придумать с 0, так что опишу их подробнее в следующих постах.

__Энджены__ - выполняют роль неких суперсервисов и/или суперконтроллеров, запускают другие энджены, сервисы, контроллеры, модели, рендереры, отвечают за определенные блоки игры, например за ход отдельного боя, манипуляции в лагере, выбор нового противника итд

__Хелперы__ - пока один хэлпер, добавленный AndriiKot https://github.com/AndriiKot , для решения `File::exists?`/`File.exist?`


В общем, архитектура на данный момент довольно сумбурная, сделанная по паттерну "Срали-мазали" и нужно много чего будет улучшать, менять итд. Но пока мой внутренний менеджер побеждает разработчика и в первую очередь хочется реализовать все задуманные фичи, добавлять новый контент, откладывая паттерны и чистоту кода на будущее, но совсем грязь стараюсь не творить, чтобы потом разгребать не слишком много.


PZDC_dungeon_2 на Github https://github.com/krillan49/PZDC_dungeon_2
